<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FactCheck — Вход</title>
    <link rel="stylesheet" href="login.css">
    <script src="auth.js"></script>
</head>
<body>
    <section>
    <div class ="login-box">
        <form action="">
            <h2>Вход</h2>
            <div class="input-box">
               <span class="icon"><ion-icon name="mail"></ion-icon></span>
                <input type="email" id="email" required>
                <label>Имейл</label>
            </div>
            <div class="input-box">
               <span class="icon"><ion-icon name="lock-closed"></ion-icon></span>
                <input type="password" id="password" required>
                <label>Пароли</label>
            </div>
          <div class="remember-forgot">
            <label class="remme"><input type="checkbox">Запомни ме</label>
            <a class="fgp" href="#">Забравихте парола?</a>
        </div> 
       <button type="button" onclick="loginUser()">Вход</button>
        <div class="register-link">
            <p>Нямате профил? <a href="register.html">Регистрирайте се</a></p>
        </div>

        </form>
        
    </div>
    </section>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const firebaseConfig = {
    apiKey: "AIzaSyCKBJKP6jI27G9cJGWm8YnQb3eqb9atrMk",
    authDomain: "factcheck-27e4c.firebaseapp.com",
    projectId: "factcheck-27e4c",
    storageBucket: "factcheck-27e4c.firebasestorage.app",
    messagingSenderId: "428640255322",
    appId: "1:428640255322:web:f604d2352f309e47288763"
  };

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.loginUser = function () {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  signInWithEmailAndPassword(auth, email, password)
    .then((userCredential) => {
      const user = userCredential.user;
      // Store user data in localStorage
      const userData = {
        email: user.email,
        uid: user.uid,
        name: user.displayName || user.email.split('@')[0]
      };
      window.setUserLogin(userData);
      alert("Вход успешен!");
      window.location.href = "index.html";
    })
    .catch((error) => {
      alert(error.message);
    });
};
</script>
</body>
</html>